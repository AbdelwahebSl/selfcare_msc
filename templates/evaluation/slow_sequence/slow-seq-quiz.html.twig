{% extends "base.html.twig" %}
 {% block title %}My Learning {% endblock %}
 {% block style %}


     <style>


         .card {
             background: white;
             border-radius: 1rem;
             box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
             overflow: hidden;
         }

         .card-header {
             background: #8D1E32;
             padding: 1.5rem;
             color: white;
         }

         .card-header h1 {
             margin: 0;
             font-size: 1.8rem;
             text-align: center;
         }

         .card-body {
             padding: 2rem;
         }

         .question-container {
             background: white;
             border-radius: 0.5rem;
             padding: 1.5rem;
             margin-bottom: 2rem;
             border: 1px solid #e0e0e0;
             transition: transform 0.2s;
         }

         .question-container:hover {
             transform: translateY(-2px);
             box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
         }

         h5 {
             color: #8D1E32;
             font-size: 1.1rem;
             margin-bottom: 1.5rem;
             font-weight: 600;
             line-height: 1.4;
         }

         .form-check {
             margin: 1rem 0;
             padding-left: 2rem;
             position: relative;
         }

         .form-check-input {
             position: absolute;
             margin-top: 0.3rem;
             margin-left: -1.5rem;
         }

         .form-check-label {
             padding-left: 0.5rem;
             cursor: pointer;
             transition: color 0.2s;
         }

         .form-check-label:hover {
             color: #8D1E32;
         }

         .correct-answer {
             background-color: #f0f9f0;
             border-left: 4px solid #28a745;
             padding: 1rem;
             margin-top: 1rem;
             border-radius: 0.25rem;
             font-weight: 500;
             /*display: block;*/
         }

         .btn-container {
             position: sticky;
             bottom: 1rem;
             padding: 1rem;
             background: rgba(255, 255, 255, 0.9);
             backdrop-filter: blur(10px);
             border-radius: 0.5rem;
             box-shadow: 0 -4px 6px rgba(0, 0, 0, 0.1);
             margin-top: 2rem;
         }

         .btn-quiz {
             padding: 0.75rem 1.5rem;
             border-radius: 0.5rem;
             font-weight: 500;
             transition: all 0.2s;
             min-width: 120px;
         }

         .btn-primary {
             background-color: #8D1E32;
             border: none;
             color: white;
         }

         .btn-primary:hover {
             background-color: #7a1a2b;
             transform: translateY(-1px);
         }

         .btn-outline-secondary {
             border: 1px solid #6c757d;
             background: white;
         }

         .btn-outline-secondary:hover {
             background-color: #f8f9fa;
         }

         .alert-primary {
             background-color: #f8f9fa;
             border-left: 4px solid #8D1E32;
             padding: 1rem;
             margin: 1rem 0;
             border-radius: 0.25rem;
         }

         #score {
             font-weight: 600;
             color: #8D1E32;
         }

         @media (max-width: 768px) {
             .container {
                 margin: 1rem auto;
             }

             .card-body {
                 padding: 1rem;
             }

             .question-container {
                 padding: 1rem;
             }

             .btn-quiz {
                 width: 100%;
                 margin: 0.5rem 0;
             }
         }
     </style>
 {% endblock %}
 {% block content %}
     {#     <button class="btn btn-success"  onclick="showToast('Operation successfully!','Score','bg-success')" >Show Success Toast</button> #}

     <!-- Toast -->

     <!-- Sample content to show styling -->
     <div class="container   my-5 " style="margin-top: 50px; margin-bottom: 50px;">
         <div class="toast-container position-fixed top-0 end-0 p-3" style="z-index: 1055;margin-top: 80px  ;">
             <div id="dynamicToast" class="toast" role="alert" aria-live="assertive" aria-atomic="true">
                 <div class="toast-header">
                     <span id="toastIcon" class="rounded me-2" style="width: 20px; height: 20px;"></span>
                     <strong id="toastTitle" class="me-auto"></strong>
                     <button type="button" class="btn-close" data-bs-dismiss="toast" aria-label="Close"></button>
                 </div>
                 <div id="toastBody" class="toast-body"></div>
             </div>
         </div>
         <div class="card">
             <div class="card-header">
                 <h1>Slow Sequence Induction</h1>
             </div>
             <div class="card-body">
                 <div class="alert alert-primary" role="alert">
                     Complete this quiz to test your knowledge of slow sequence induction procedures.
                 </div>
                 <div id="score-display" class="alert alert-primary d-none" role="alert">
                     Your score: <span id="score">0</span> out of 11
                 </div>
                 <form id="quiz-form" method="post">
                     <div class="question-container">
                         <h5>Question 1: Before beginning anesthesia induction, the anesthesia station must be checked.
                             Which of
                             the
                             following are the standard preoperative checks of the anesthesia workstation?</h5>
                         <div class="form-check">
                             <input class="form-check-input" type="checkbox" name="q1" value="A" id="q1a">
                             <label class="form-check-label" for="q1a">A. Ensure the availability of a functioning
                                 suction
                                 unit</label>
                         </div>
                         <div class="form-check">
                             <input class="form-check-input" type="checkbox" name="q1" value="B" id="q1b">
                             <label class="form-check-label" for="q1b">B. Verify the oxygen supply and gas
                                 pipelines</label>
                         </div>
                         <div class="form-check">
                             <input class="form-check-input" type="checkbox" name="q1" value="C" id="q1c">
                             <label class="form-check-label" for="q1c">C. Confirm the presence of anesthesia drugs,
                                 including
                                 induction agents</label>
                         </div>
                         <div class="form-check">
                             <input class="form-check-input" type="checkbox" name="q1" value="D" id="q1d">
                             <label class="form-check-label" for="q1d">D. Ensure the availability of intraoperative
                                 monitoring
                                 equipment for pain management</label>
                         </div>
                         <div class="correct-answer">
                             Correct answer: A, B, C
                         </div>
                     </div>

                     <div class="question-container">
                         <h5>Question 2: What precautions should be taken before anesthesia induction?</h5>
                         <div class="form-check">
                             <input class="form-check-input" type="checkbox" name="q2" value="A" id="q2a">
                             <label class="form-check-label" for="q2a">A. Verify the patient's identity and ensure
                                 preoperative
                                 fasting</label>
                         </div>
                         <div class="form-check">
                             <input class="form-check-input" type="checkbox" name="q2" value="B" id="q2b">
                             <label class="form-check-label" for="q2b">B. Verify the patient's records</label>
                         </div>
                         <div class="form-check">
                             <input class="form-check-input" type="checkbox" name="q2" value="C" id="q2c">
                             <label class="form-check-label" for="q2c">C. Administer a sedative to the patient</label>
                         </div>
                         <div class="form-check">
                             <input class="form-check-input" type="checkbox" name="q2" value="D" id="q2d">
                             <label class="form-check-label" for="q2d">D. Check if the peripheral intravenous line is
                                 patent</label>
                         </div>
                         <div class="correct-answer">
                             Correct answer: A, B, D
                         </div>
                     </div>

                     <div class="question-container">
                         <h5>Question 3: Which of the following steps is typically performed before the administration
                             of a
                             neuromuscular blocking agent in slow sequence induction?</h5>
                         <div class="form-check">
                             <input class="form-check-input" type="radio" name="q3" value="A" id="q3a" required>
                             <label class="form-check-label" for="q3a">A. Ensure the patient is pre-oxygenated with
                                 100%
                                 oxygen for
                                 at least 3 minutes</label>
                         </div>
                         <div class="form-check">
                             <input class="form-check-input" type="radio" name="q3" value="B" id="q3b" required>
                             <label class="form-check-label" for="q3b">B. Administer a sedative and opioid
                                 together</label>
                         </div>
                         <div class="form-check">
                             <input class="form-check-input" type="radio" name="q3" value="C" id="q3c" required>
                             <label class="form-check-label" for="q3c">C. Administer a paralytic agent immediately
                                 after
                                 induction</label>
                         </div>
                         <div class="form-check">
                             <input class="form-check-input" type="radio" name="q3" value="D" id="q3d" required>
                             <label class="form-check-label" for="q3d">D. Insert a nasogastric tube to empty the
                                 stomach</label>
                         </div>
                         <div class="correct-answer">
                             Correct answer: A
                         </div>
                     </div>

                     <div class="question-container">
                         <h5>Question 4: Which of the following agents is not considered ideal for slow sequence induction due to its rapid onset and short duration of action?</h5>
                         <div class="form-check">
                             <input class="form-check-input" type="radio" name="q4" value="A" id="q4a" required>
                             <label class="form-check-label" for="q4a">A. Succinylcholine</label>
                         </div>
                         <div class="form-check">
                             <input class="form-check-input" type="radio" name="q4" value="B" id="q4b" required>
                             <label class="form-check-label" for="q4b">B. Rocuronium</label>
                         </div>
                         <div class="form-check">
                             <input class="form-check-input" type="radio" name="q4" value="C" id="q4c" required>
                             <label class="form-check-label" for="q4c">C. Cisatracurium</label>
                         </div>
                         <div class="form-check">
                             <input class="form-check-input" type="radio" name="q4" value="D" id="q4d" required>
                             <label class="form-check-label" for="q4d">D. Atracurium</label>
                         </div>
                         <div class="correct-answer">
                             Correct answer: A
                         </div>
                     </div>

                     <div class="question-container">
                         <h5>Question 5: Preoxygenation in anesthesia is performed to:</h5>
                         <div class="form-check">
                             <input class="form-check-input" type="checkbox" name="q5" value="A" id="q5a">
                             <label class="form-check-label" for="q5a">A. Increase oxygen reserves</label>
                         </div>
                         <div class="form-check">
                             <input class="form-check-input" type="checkbox" name="q5" value="B" id="q5b">
                             <label class="form-check-label" for="q5b">B. Prevent hypoxemia that could occur during
                                 difficult
                                 intubation and/or ventilation</label>
                         </div>
                         <div class="form-check">
                             <input class="form-check-input" type="checkbox" name="q5" value="C" id="q5c">
                             <label class="form-check-label" for="q5c">C. Be performed routinely before every anesthesia
                                 induction</label>
                         </div>
                         <div class="form-check">
                             <input class="form-check-input" type="checkbox" name="q5" value="D" id="q5d">
                             <label class="form-check-label" for="q5d">D. Be performed only in high-risk situations of
                                 hypoxemia
                                 during induction</label>
                         </div>
                         <div class="correct-answer">
                             Correct answer: A, B, C
                         </div>
                     </div>

                     <div class="question-container">
                         <h5>Question 6: What is the typical sequence of drug administration in a slow sequence
                             induction?</h5>
                         <div class="form-check">
                             <input class="form-check-input" type="radio" name="q6" value="A" id="q6a" required>
                             <label class="form-check-label" for="q6a">A. Sedative → Opioid → Neuromuscular
                                 blocker</label>
                         </div>
                         <div class="form-check">
                             <input class="form-check-input" type="radio" name="q6" value="B" id="q6b" required>
                             <label class="form-check-label" for="q6b">B. Neuromuscular blocker → Hypnotic →
                                 Opioid</label>
                         </div>
                         <div class="form-check">
                             <input class="form-check-input" type="radio" name="q6" value="C" id="q6c" required>
                             <label class="form-check-label" for="q6c">C. Hypnotic → Opioid → Neuromuscular
                                 blocker</label>
                         </div>
                         <div class="form-check">
                             <input class="form-check-input" type="radio" name="q6" value="D" id="q6d" required>
                             <label class="form-check-label" for="q6d">D. Opioid → Neuromuscular blocker →
                                 Hypnotic</label>
                         </div>
                         <div class="correct-answer">
                             Correct answer: C
                         </div>
                     </div>

                     <div class="question-container">
                         <h5>Question 7: In the context of slow sequence induction, what is the main role of intravenous
                             fluids
                             during the procedure?</h5>
                         <div class="form-check">
                             <input class="form-check-input" type="radio" name="q7" value="A" id="q7a" required>
                             <label class="form-check-label" for="q7a">A. To rapidly induce anesthesia</label>
                         </div>
                         <div class="form-check">
                             <input class="form-check-input" type="radio" name="q7" value="B" id="q7b" required>
                             <label class="form-check-label" for="q7b">B. To maintain circulatory volume and prevent
                                 hypotension</label>
                         </div>
                         <div class="form-check">
                             <input class="form-check-input" type="radio" name="q7" value="C" id="q7c" required>
                             <label class="form-check-label" for="q7c">C. To enhance the effects of muscle
                                 relaxants</label>
                         </div>
                         <div class="form-check">
                             <input class="form-check-input" type="radio" name="q7" value="D" id="q7d" required>
                             <label class="form-check-label" for="q7d">D. To facilitate quick intubation</label>
                         </div>
                         <div class="correct-answer">
                             Correct answer: B
                         </div>
                     </div>

                     <div class="question-container">
                         <h5>Question 8: During slow sequence induction, if the patient begins to desaturate (oxygen
                             saturation
                             drops
                             below 90%) before intubation, what should be the immediate action?</h5>
                         <div class="form-check">
                             <input class="form-check-input" type="radio" name="q8" value="A" id="q8a" required>
                             <label class="form-check-label" for="q8a">A. Continue with the planned induction and
                                 intubate as
                                 soon as
                                 possible</label>
                         </div>
                         <div class="form-check">
                             <input class="form-check-input" type="radio" name="q8" value="B" id="q8b" required>
                             <label class="form-check-label" for="q8b">B. Administer additional sedative agents to
                                 deepen
                                 anesthesia</label>
                         </div>
                         <div class="form-check">
                             <input class="form-check-input" type="radio" name="q8" value="C" id="q8c" required>
                             <label class="form-check-label" for="q8c">C. Enhance bag-valve-mask ventilation by
                                 increasing
                                 ventilation rate and oxygen flow</label>
                         </div>
                         <div class="form-check">
                             <input class="form-check-input" type="radio" name="q8" value="D" id="q8d" required>
                             <label class="form-check-label" for="q8d">D. Administer a dose of muscle relaxants to
                                 facilitate
                                 intubation</label>
                         </div>
                         <div class="correct-answer">
                             Correct answer: C
                         </div>
                     </div>

                     <div class="question-container">
                         <h5>Question 9: What are the most likely causes of bradycardia during slow sequence
                             induction?</h5>
                         <div class="form-check">
                             <input class="form-check-input" type="checkbox" name="q9" value="A" id="q9a">
                             <label class="form-check-label" for="q9a">A. Overdose of sedative agents</label>
                         </div>
                         <div class="form-check">
                             <input class="form-check-input" type="checkbox" name="q9" value="B" id="q9b">
                             <label class="form-check-label" for="q9b">B. Hypovolemia from inadequate
                                 pre-oxygenation</label>
                         </div>
                         <div class="form-check">
                             <input class="form-check-input" type="checkbox" name="q9" value="C" id="q9c">
                             <label class="form-check-label" for="q9c">C. Vagal response to the laryngoscopy or
                                 intubation</label>
                         </div>
                         <div class="form-check">
                             <input class="form-check-input" type="checkbox" name="q9" value="D" id="q9d">
                             <label class="form-check-label" for="q9d">D. Allergic reaction to the anesthetic
                                 drugs</label>
                         </div>
                         <div class="correct-answer">
                             Correct answer: A, C
                         </div>
                     </div>

                     <div id="score-display" class="alert alert-primary d-none" role="alert">
                         Your score: <span id="score">0</span> out of 11
                     </div>

                     <!-- Previous questions remain the same -->

                     <div class="question-container">
                         <h5>Question 10: In the event of hypotension during slow sequence induction, which of the
                             following
                             interventions would be most appropriate?</h5>
                         <div class="form-check">
                             <input class="form-check-input" type="checkbox" name="q10" value="A" id="q10a">
                             <label class="form-check-label" for="q10a">A. Increase the rate of anesthetic agent
                                 administration</label>
                         </div>
                         <div class="form-check">
                             <input class="form-check-input" type="checkbox" name="q10" value="B" id="q10b">
                             <label class="form-check-label" for="q10b">B. Administer intravenous fluids to support
                                 circulation</label>
                         </div>
                         <div class="form-check">
                             <input class="form-check-input" type="checkbox" name="q10" value="C" id="q10c">
                             <label class="form-check-label" for="q10c">C. Deepen the level of anesthesia by increasing
                                 sedative
                                 drugs</label>
                         </div>
                         <div class="form-check">
                             <input class="form-check-input" type="checkbox" name="q10" value="D" id="q10d">
                             <label class="form-check-label" for="q10d">D. Administer a vasoconstrictor</label>
                         </div>
                         <div class="correct-answer">
                             Correct answer: B, D
                         </div>
                     </div>

                     <div class="question-container">
                         <h5>Question 11: What is the most likely cause of post-induction hypertension (high blood
                             pressure) in
                             a
                             patient undergoing slow sequence induction?</h5>
                         <div class="form-check">
                             <input class="form-check-input" type="radio" name="q11" value="A" id="q11a">
                             <label class="form-check-label" for="q11a">A. Inadequate sedation during induction</label>
                         </div>
                         <div class="form-check">
                             <input class="form-check-input" type="radio" name="q11" value="B" id="q11b">
                             <label class="form-check-label" for="q11b">B. Pain response during intubation</label>
                         </div>
                         <div class="form-check">
                             <input class="form-check-input" type="radio" name="q11" value="C" id="q11c">
                             <label class="form-check-label" for="q11c">C. Hypercapnia due to inadequate ventilation after muscle relaxation</label>
                         </div>
                         <div class="form-check">
                             <input class="form-check-input" type="radio" name="q11" value="D" id="q11d">
                             <label class="form-check-label" for="q11d">D. Muscle relaxant overdose leading to sympathetic activation</label>
                         </div>
                         <div class="correct-answer">
                             Correct answer: B
                         </div>
                     </div>
                     <div class=" text-end">
                         <button class="btn btn-primary" type="submit">Submit Quiz</button>
                         <button class="btn btn-outline-secondary" type="button" onclick="resetQuiz()">Reset Quiz
                         </button>
                     </div>
                     <div class=" text-start">
                         <div class="formbold-form-btn-wrapper">


                             <div class="row">

                                 <div class="col">
                                     <a class="" href="{{ path('workshop_show_content',{'id':workshop.id}) }}"
                                        style="background-color:#FFFFFF;  color:  #69313a; font-size: 20px">
                                         <i class="fas fa-angle-left "></i>
                                         Back
                                     </a>
                                 </div>
                             </div>
                         </div>
                     </div>
                 </form>


             </div>
         </div>
     </div>


 {% endblock %}

{% block javaScript %}


    <script>
        document.querySelectorAll('.correct-answer').forEach(element => {
            element.style.display = 'none';
        });

        document.getElementById('quiz-form').addEventListener('submit', function (e) {
            e.preventDefault();

            // Correct answers
            const correctAnswers = {
                q1: ['A', 'B', 'C'],
                q2: ['A', 'B', 'D'],
                q3: ['A'],
                q4: ['A'],
                q5: ['A', 'B', 'C'],
                q6: ['C'],
                q7: ['B'],
                q8: ['C'],
                q9: ['A', 'C'],
                q10: ['B', 'D'],
                q11: ['B']
            };

            let score = 0;

            // Calculate score for checkbox questions
            ['q1', 'q2', 'q5', 'q9', 'q10'].forEach(question => {
                const selected = Array.from(document.querySelectorAll(`input[name="${question}"]:checked`))
                    .map(input => input.value);

                if (arrayEquals(selected.sort(), correctAnswers[question].sort())) {
                    score++;
                }

                // Highlight correct answers in green and wrong answers in red
                document.querySelectorAll(`input[name="${question}"]`).forEach(input => {

                });
            });

            // Calculate score for radio questions
            ['q3', 'q4', 'q6', 'q7', 'q8', 'q11'].forEach(question => {
                const selected = document.querySelector(`input[name="${question}"]:checked`)?.value;
                if (selected && correctAnswers[question].includes(selected)) {
                    score++;
                }

                // Highlight correct answers in green and wrong answers in red
                const input = document.querySelector(`input[name="${question}"]:checked`);
                if (input) {
                    const parent = input.parentElement;

                }
            });

            // Display score
            const scoreDisplay = document.getElementById('score-display');
            const scoreElement = document.getElementById('score');
            if (scoreDisplay && scoreElement) {
                scoreDisplay.classList.remove('d-none');
                scoreElement.textContent = score;

                // Show correct answers
                document.querySelectorAll('.correct-answer').forEach(element => {
                    element.style.display = 'block';
                });

                // Show toast with the score
                var color = 'bg-danger';
                if (score < 5) color = 'bg-danger';
                if (score >= 5 && score < 7) color = 'bg-warning';
                if (score >= 7) color = 'bg-success';

                showToast('Your score: ' + score, 'Score', color);
            }

            window.scrollTo({
                top: 0,
                behavior: 'smooth' // Smooth scroll to the top
            });
            var id = {{ id_workshopCart }};
            $.ajax({
                method: "GET",
                //async: false,
                url: "{{ path('app_api_update_wrk_shop_crt_add') }}",
                data: {id: id, type: 2},
                contentType: "application/json",
                success: function (r) {
                    console.log(r);
                    document.getElementById('btnSubmit').disabled = true;
                }
            });
        });

        function arrayEquals(a, b) {
            return Array.isArray(a) && Array.isArray(b) &&
                a.length === b.length &&
                a.every((val, index) => val === b[index]);
        }

        function resetQuiz() {
            document.getElementById('btnSubmit').disabled = false;
            const quizForm = document.getElementById('quiz-form');
            const scoreDisplay = document.getElementById('score-display');
            if (quizForm) quizForm.reset();
            if (scoreDisplay) scoreDisplay.classList.add('d-none');
            document.querySelectorAll('.correct-answer').forEach(element => {
                element.style.display = 'none';
            });
            document.querySelectorAll('.form-check').forEach(element => {
                element.classList.remove('bg-success', 'bg-danger');
            });
        }

        function showToast(message, title, colorClass) {
            // Update dynamic content
            const toastTitle = document.getElementById('toastTitle');
            const toastBody = document.getElementById('toastBody');
            const toastIcon = document.getElementById('toastIcon');

            toastTitle.textContent = title; // Toast title
            toastBody.textContent = message; // Toast body
            toastIcon.className = colorClass + ' rounded me-2'; // Icon color

            // Show toast
            const toastElement = document.getElementById('dynamicToast');
            const toast = new bootstrap.Toast(toastElement);
            toast.show();
        }

    </script>
{% endblock %}